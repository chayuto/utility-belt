Deep analyse into this feature.  give a detailed plan in staged to be implemented, we want comprehensive, maintainable lib. 

put your plan in docs/planning

dated documents, main doc and also each stage in seperate file

well archietec as senior software expert. maintanable code, production grade


Before start the task DEEP research into all the code base. Methodically. Do not rush. Create intermedate document in .md if need to. Spend as much tokens and thinking time as you can. 

